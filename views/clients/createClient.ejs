<%- include('../partials/header') -%>

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">Créer un nouveau client</h4>
                </div>
                <div class="card-body" >
                    <form action="create-client" method="POST">
                        <div class="mb-3">
                            <label for="firstName" class="form-label">Prénom</label>
                            <input type="text" class="form-control" id="firstName" name="firstName" placeholder="John" required>
                        </div>
                        <div class="mb-3">
                            <label for="lastName" class="form-label">Nom de famille</label>
                            <input type="text" class="form-control" id="lastName" name="lastName" placeholder="Doe" required>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Adresse e-mail</label>
                            <input type="email" class="form-control" id="email" name="email" placeholder="exemple@gmail.com" required>
                        </div>
                        <div class="mb-3">
                            <label for="phoneNumber" class="form-label">Numéro de tél</label>
                            <input type="phoneNumber" class="form-control" id="phoneNumber" name="phoneNumber" placeholder="+3300000000" required>
                        </div>
                        <div class="mb-3">
                            <label for="adresse" class="form-label">Adresse postal</label>
                            <input type="adresse" class="form-control" id="adresse" name="adresse" placeholder="adresse complete" required>
                        </div>
                        <div class="mb-3">
                            <label for="companyName" class="form-label">Nom d'entreprise <span style="color:rgba(26, 2, 2, 0.381)">   si le type de client est entreprise </span></label>
                            <input type="companyName" class="form-control" id="companyName" name="companyName" placeholder="Pluricap">
                        </div>
                        
                        <% if (user.role === "kingAdmin") { %>
                            <div class="mb-3">
                                <label for="userName" class="form-label">User Name</label>
                                <select class="form-select" id="userName" name="userName" required>
                                <option value="" selected disabled>Select a user</option>
                                <% let currentEstablishment = null; %>
                                <% users.forEach(findUser => { %>
                                    <% if (findUser.Establishment.id !== currentEstablishment) { %>
                                    <optgroup label="<%= findUser.Establishment.name %>" disabled></optgroup>
                                    <% currentEstablishment = findUser.Establishment.id; %>
                                    <% } %>
                                    <option value="<%= findUser.id %>"><%= findUser.firstName %> <%= findUser.lastName %></option>
                                <% }); %>
                                </select>
                            </div>
                        <% } %>
                        
                        
                        <div align="center">
                            <button type="submit"  class="btn btn-primary">Ajouter un client</button>
                            <!-- <a href="/login" class="btn btn-secondary">Login</a> -->
                        </div>
                    </form>

                    <% if (typeof errorMessage !== 'undefined') { %>
                        <div class="alert alert-danger mt-3">
                            <%= errorMessage %>
                        </div>
                    <% } %>
                </div>
            </div>
        </div>
    </div>
</div>



<%- include('../partials/footer') -%>
