<%- include('../partials/header') -%>
<link rel="stylesheet" href="/css/timePicker.css">

</head>
<body>
  <% let capacity %>
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h1 class="mb-2">Créer une nouvelle Reservation</h1> 
        </div>
        <div class="card-body">
          <p>
            Ce formulaire génère un devis en pdf, assurez-vous de le sauvegarder, puis revenez plus tard pour changer le statut lorsque le devis est validé par le client
          </p>
          <br/>
          <form action="/reservations/create" method="POST">
            
            <div class="mb-3">
              <!-- add create client permission here before the link -->
              <label for="clientId" class="form-label">Select Client  <a href="/clients/create-client" style="color:rgba(26, 2, 2, 0.381)"> or create new client here </a> </label>
              <select class="form-control" id="clientId" name="clientId" required>
                <% clients.forEach((client) => { %>
                <option value="<%= client.id %>"><%= client.firstName %> <%= client.lastName %></option>
                <% }); %>
              </select>
            </div>

            <!-- <div class="mb-3">
              <label for="salleId" class="form-label">Sélectionner la salle</label>
              <select class="form-control" id="salleId" name="salleId" required>
                <option value="" disabled selected>Select a room</option>
                <% rooms.forEach((room) => {  %>
                 
                  <option value="<%= room.id %>" data-capacity="<%= room.capacity %>" <%= room.id === roomId ? 'selected' : '' %>><%= room.name %></option>
                <% }); %>
              </select>
             
            </div> -->
            <div class="mb-3">
              <label for="salleId" class="form-label">Sélectionner la salle</label>
              <select class="form-control" id="salleId" name="salleId" required>
                
                <% rooms.forEach((room) => { %>
                  <option value="<%= room.id %>" data-capacity="<%= room.capacity %>" <%= room.id === roomId ? 'selected' : '' %>><%= room.name %></option>
                <% }); %>
              </select>
            </div>
            
           
                   

            <div class="mb-3">
              <label for="startDate" class="form-label">Date</label>
              <input type="date" class="form-control" id="startDate" name="startDate" required>
            </div>

            <div class="mb-3 time-picker">
              <label for="time" class="form-label">Heure</label>
              <input type="time" class="form-control" id="startTime" name="startTime" required>
              <div class="time-options" id="time-options1">
                <!-- Options will be automatically generated by JavaScript -->
              </div>
            </div>

            <div class="mb-3 time-picker">
              à <input type="time" class="form-control" id="endTime" name="endTime" required>
              <div class="time-options" id="time-options2">
                <!-- Options will be automatically generated by JavaScript -->
              </div>
            </div>

            <div class="mb-3">
              <label for="objet" class="form-label">Objet</label>
              <input type="text" class="form-control" id="objet" name="objet" placeholder="Optional Reason">
            </div>

            <div class="mb-3">
            
              <label id="capacity"></label>
              <br/>
              <label for="nbrPeople" class="form-label">Nombre de personnes <span style="color:rgba(26, 2, 2, 0.381)">  nomber of people must be less than the capacity </span></label>
              <input type="number" class="form-control" id="nbrPeople" name="nbrPeople" min=1 required>
            </div>

            <div align="center">
              <button type="submit" class="btn btn-primary">Créer la reservation et Télécharger le devis</button>
              <a href="/reservations" class="btn btn-primary">go back</a>
            </div>
          </form>

          

          <% if (typeof errorMessage !== 'undefined') { %>
          <div class="alert alert-danger mt-3">
            <%= errorMessage %>
          </div>
          <% } %>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="/js/timePicker.js"></script>

<script src="/js/setCapacity.js"></script>
</body>

<!-- <%- include('../partials/footer') -%> -->
